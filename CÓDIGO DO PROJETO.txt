#include <LiquidCrystal.h>

const int rs = 12, en = 11, d4 = 5, d5 = 4, d6 = 3, d7 = 2;
LiquidCrystal lcd(rs, en, d4, d5, d6, d7);
const int ledVermelho = 6;
const int ledVerde = 7;
const int botao1 = 10;
const int botao2 = 9;
const int botao3 = 8;

void setup() {
  pinMode(ledVermelho, OUTPUT);
  pinMode(ledVerde, OUTPUT);
  pinMode(botao1, INPUT);
  pinMode(botao2, INPUT);
  pinMode(botao3, INPUT);
  lcd.begin(16, 2);
  randomSeed(analogRead(A0));
  lcd.print("Ola!");
  lcd.setCursor(0, 1);
  lcd.print("Vamos la!");
  delay(2000);
  lcd.clear();
  lcd.setCursor(0, 0);
}

void correto(){
  digitalWrite(ledVerde, HIGH);
  lcd.clear();
  lcd.print("BOA!");
  delay(2000);
  digitalWrite(ledVerde, LOW);
  lcd.clear();
}

void incorreto(){
  digitalWrite(ledVermelho, HIGH);
  lcd.clear();
  lcd.print("ERROU :(");
  delay(2000);
  digitalWrite(ledVermelho, LOW);
  lcd.clear();
}

void loop(){
  int operacao = random(1,3);
  int primeiro;
  int segundo;
  int resposta;
  
  switch(operacao) {
    case 1:
      primeiro = random(10,100);
      segundo = random(10,100);
      resposta = primeiro + segundo;
      break;
    case 2:
      segundo = random(10,100);
      primeiro = random(segundo, (segundo+50));
      resposta = primeiro - segundo;
      break;
  }
  
  int arrayNumeros[3];
  int maisMenos = random(1,3);
  arrayNumeros[0] = resposta;
  
  if(maisMenos == 1) {
    arrayNumeros[1] = resposta + random(1,50);
  } else {
    arrayNumeros[1] = resposta - random(1,50);
  }
  
  if(maisMenos == 1) {
    arrayNumeros[2] = resposta + random(1,50);
  } else {
    arrayNumeros[2] = resposta - random(1,50);
  }
  
  const size_t n = sizeof(arrayNumeros) / sizeof(arrayNumeros[0]);

  for (size_t i = 0; i < n - 1; i++) {
    size_t j = random(0, n - i);

    int temp = arrayNumeros[i];
    arrayNumeros[i] = arrayNumeros[j];
    arrayNumeros[j] = temp;
  }
  
  lcd.print("   ");
  lcd.print(primeiro);
  switch(operacao) {
    case 1:
      lcd.print(" + ");
      break;
    case 2:
      lcd.print(" - ");
      break;
  }
  lcd.print(segundo);
  lcd.print(" = ?");
  lcd.setCursor(0, 1);
  lcd.print(arrayNumeros[0]);
  lcd.print("    ");
  lcd.print(arrayNumeros[1]);
  lcd.print("   ");
  lcd.print(arrayNumeros[2]);
  
  while(true) {
    if(digitalRead(botao1) == HIGH){
      if(resposta == arrayNumeros[0]) {
        correto();
        break;
      } else {
        incorreto();
        break;
      }
    } else if(digitalRead(botao2) == HIGH){
      if(resposta == arrayNumeros[1]) {
        correto();
        break;
      } else {
        incorreto();
        break;
      }
    } else if(digitalRead(botao3) == HIGH){
      if(resposta == arrayNumeros[2]) {
        correto();
        break;
      } else {
        incorreto();
        break;
      }
    }
  }
}
